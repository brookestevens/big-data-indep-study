<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ATLS 4900</title>
    <meta name="description" content="Big data stuff">
    <meta name="author" content="Brooke">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/110/three.js" crossorigin="anonymous"></script>
    <!-- <script src="./assets/OrbitControls.js"></script> -->
    <script src="./assets/EffectComposer.js"></script>
    <script src="./assets/RenderPass.js"></script>
    <script src="/assets/ShaderPass.js"></script>
    <script src="/assets/CopyShader.js"></script>
    <script src="/assets/LuminosityHighPassShader.js"></script>
    <script src="/assets/UnrealBloomPass.js"></script>
    <style>
      @import url('https://fonts.googleapis.com/css?family=Rajdhani&display=swap');
      body{
        margin: 0;
        background-color: black;
        min-height: 100%;
        overflow: hidden;
        font-family: 'Rajdhani', sans-serif;
      }
      h2{
        font-size: 4em;
        margin: 0;
        text-align: center;
        letter-spacing: 4px;
      }
      h3{
        font-size: 3em;
        text-align: center;
      }
      #main-header{
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        align-items: baseline;
      }
      #button-div{
        display: flex;
        justify-content: space-evenly;
      }
      .button-next{
        margin: 1em;
        padding: 1em;
        background-color: black;
        border: solid 1px red;
        color: white;
      }
      a:hover{
        color: red;
      }
      a{
        text-decoration: none;
        color: white;
      }
    
    </style>
  </head>
  <body>
    <div id="main-header">
      <h2> ATLS 4900 </h2>
      <h3> Brooke Stevens </h3>
      <div id="button-div">
        <button class="button-next"> <a href="/music"> Music Visualizer </a> </button>
        <button class="button-next"> <a href="/genome"> Big Data Genome Mapping </a> </button>
      </div>
    </div>
    <!-- Three.js app renders here -->
  </body>
  <script>
    //globals
    const t = THREE;
    const PI = Math.PI;
    const s = 30;
    var bloomParams = {
      exposure: 1,
      bloomStrength: 1.5,
      bloomThreshold: 0,
      bloomRadius: 1,
    };

    function drawSpirograph(R,r,a){
      let material = new t.LineBasicMaterial( { 
        color : 0xff0000
      });
      let arr = [];
      for(let i = 0; i<= 360*R; i++){
        //add points to the curve
        let x = 5*(R-r)*Math.cos((r/R)*i)+a*Math.cos((1-(r/R))*i);
        let y = 5*(R-r)*Math.sin((r/R)*i)-a*Math.sin((1-(r/R))*i);
        arr.push(new t.Vector2(x,y));
      }
      let curve = new t.SplineCurve(arr);
      let geometry = new t.BufferGeometry().setFromPoints( curve.getSpacedPoints( 5000 ) );
      return new t.Line(geometry, material);
    }
    
    function animate(scene, camera, renderer, composer){
      scene.getObjectByName('s1').rotation.z += .004;
      scene.getObjectByName('s2').rotation.z -= .003;
      scene.getObjectByName('s3').rotation.z += .002;
      // console.log("camera x: ", camera.position.x );
      // console.log("camera y: ", camera.position.y );
      // console.log("camera z: ", camera.position.z );
      //controls.update();
      requestAnimationFrame(() => animate(scene, camera, renderer, composer));
      //renderer.render(scene, camera);
      composer.render();
    }

    (function(){
      //init
      let scene = new t.Scene();
      scene.background = new t.Color(0x0A0F16);
      let camera = new t.PerspectiveCamera( 45, window.innerWidth/window.innerHeight, 1, 1000);
      let c = document.getElementById('root');
      let renderer = new t.WebGLRenderer({c, alpha: true});
      camera.position.set(0,0,70);
      //camera.rotateZ(PI/4);
      //camera.rotateY(PI/6);
      //camera.lookAt(0,0,0);
      renderer.setSize(window.innerWidth, window.innerHeight);
      let composer = new t.EffectComposer(renderer);
      let renderpass = new t.RenderPass(scene, camera);
      composer.addPass(renderpass);
      let bloom = new t.UnrealBloomPass( new t.Vector2( window.innerWidth, window.innerHeight ), .5, 0, 0);
      bloom.renderToScreen = true;
      composer.addPass(bloom);
      //renderer.setClearColor(0x000000);
      let spiro = drawSpirograph(4,1.1,3);
      let spiro2 = drawSpirograph(8,3,2);
      let spiro3 = drawSpirograph(10,2.7,6);

      spiro.name = 's1';
      spiro2.name = 's2';
      spiro3.name = 's3';

      scene.add(spiro);
      scene.add(spiro2);
      scene.add(spiro3);
      
      document.body.appendChild(renderer.domElement);
      //let controls = new t.OrbitControls(camera, renderer.domElement);
      animate(scene, camera, renderer, composer);
    })();

  </script>
</html>